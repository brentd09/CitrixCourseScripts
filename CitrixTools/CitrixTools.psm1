<#
  Functions in this module
    Get-DeliveryGroupAssignments
    Get-CitrixLoadIndex
    Get-AppSession
    Move-CitrixPolicy
    Get-IdleHDXSessions
    Get-NetScalerInfo
    Import-CitrixPolicyModule
#>

function Get-CitrixSessionInfo {
  <#
  .Synopsis
     Creates a webpage view of HDX connection info
  .DESCRIPTION
     This script creates a web page from HDX connection data.
  .EXAMPLE
     Get-HDXConnInfo -Controller <ServerName> -ReportFilePath 'C:\InetPub\WWWroot\Report.html' -OverWriteReport
     This will create a web based report called Report.html and overwrite any existing report with the same name
  .NOTES
     General notes
     Created by: Brent Denny
     Created on: 25 Aug 2018
     Last Modified: 21 Oct 2019

  #>
  [CmdletBinding()]
  Param (
  [Parameter(Mandatory=$true)]  
    [string]$Controller,
    [string]$ReportFilePath,
    [switch]$OverWriteReport
  )
  
  try { 
    $ReportDirPath = Split-Path $ReportFilePath -ErrorAction Stop
    if ($ReportFilePath -notmatch '.+\.html?$') {throw 'FileName Error'}
    $ReportDirPathExists = Test-Path $ReportDirPath
    $ReportFilePathExists = Test-Path $ReportFilePath
  }
  catch {Write-Warning 'Report path is not valid';break}
  if ($ReportDirPathExists -eq $false) {Write-Warning 'Path does not exist'; break}
  if ($ReportFilePathExists -eq $true -and $OverWriteReport -eq $false) {Write-Warning 'Report already exists, try again and use the -OverWiteReport parameter to overwrite the existing file'; break}


  Add-PSSnapin *citrix*
  
  $ServerExists = Test-Connection -quiet $Controller
  if ($ServerExists) {
    # the following is the style sheet
    $CSS = @'
<style>
H1 {text-align:center;}
BODY{background-color:peachpuff;}
TABLE{border-width: 1px;border-style: solid;border-color: black;border-collapse: collapse;}
TH{border-width: 1px;padding: 5px;border-style: solid;border-color: black;background-color:thistle}
TD{border-width: 1px;padding: 5px;border-style: solid;border-color: black;background-color:PaleGoldenrod}
</style>
'@
    Get-BrokerSession -AdminAddress $Controller | 
      Select-Object -Property ConnectedViaHostName,MachineName,ClientAddress | 
      ConvertTo-Html -head $CSS -Body "<H1>Connection Information</H1>"  | 
      Out-File $ReportFilePath
  }  
}
function Get-DeliveryGroupAssignments {
  Add-PSSnapin *citrix*
  Import-Module *citrix*

  Get-BrokerDesktopGroup | ForEach-Object {
    Get-BrokerAccessPolicyRule -DesktopGroupName $_.name 
  } | 
    Sort-Object allowedconnections | 
     Select-Object -Property @{n='ViaNetScalerGW';e={if ($_.AllowedConnections -eq "ViaAG"){$true}else{$false}}}, 
                             @{n='DeliveryGroup';e={$_.DesktopGroupName}},
                             IncludedUsers 
}

function Get-CitrixLoadIndex {
  Add-PSSnapin *citrix*
  Get-BrokerMachine | 
    Select-Object -Property MachineName,LoadIndex, RegistrationState,InMaintenanceMode
}

function Get-AppSession {
  Add-PSSnapin *citrix*
  foreach ($Session in (Get-brokerSession)) {
    foreach ($App in $Session.ApplicationsInUse) {
      $Session | 
        Select-Object @{n='Application';e={$App}},
                      @{n='VDAMachine';e={($_.MachineName -split '\\')[-1]}},
                      @{n='Username';e={$_.UserFullName}},
                      @{n='UpTime (Min)';e={ '{0,12:N2}' -f (((get-date)-$_.starttime).TotalMinutes)}},
                      @{n='Status';e={$_.MachineSummaryState}},
                      @{n='ClientPC';e={$_.ReceiverName}},
                      @{n='ClientIP';e={$_.ReceiverIPAddress}},
                      @{n='SessionID';e={$_.Uid}} 
    }
  }
}

Function Move-CitrixPolicy {
  <#
  .Synopsis
     This will move a Citrix Studio Policy to a specified priority
  .DESCRIPTION
     Given a policy name and priority and policy bank (User or Computer)
     This script will instantly move a policy to the given priority
  .EXAMPLE
     Move-CitrixPolicy -PolicyName PolicyA -NewPriority 2 -PolicyBank Computer -Controller NYC-VDC-001
  .EXAMPLE
     Move-CitrixPolicy
  .NOTES
     General notes
     Created: 
       On: 29-Nov-2018
       By: Brent Denny
  #>
  [cmdletbinding()]
  Param(
    [Parameter(Mandatory=$true)]
    [string]$PolicyName,
    [Parameter(Mandatory=$true)]
    [int]$NewPriority,
    [Parameter(Mandatory=$true)]
    [ValidateSet("User", "Computer")]
    [String]$PolicyBank,
    [string]$Controller = "LocalHost"
  
  )
  try {
    Add-PSSnapin *Citrix*
    # Configure a PSDrive to Policy DB
    New-PSDrive -Name CTXPolicy -PSProvider CitrixGroupPolicy -Root \ -Controller $Controller
  }
  Catch {
    Write-Warning "An error occured loading the Citrix modules"
    break
  }
  # Locate policy in question
  $CurrentPolicies = Get-ChildItem CTXPolicy:\$PolicyBank
  $PolicyFocus = $CurrentPolicies | Where-Object {$_.Name -eq $PolicyName}
  # Modify the settings in the policy to force it to the desired priority
  Set-ItemProperty -Path $PolicyFocus.PSPath -Name Priority -Value $NewPriority
}

function Get-IdleHDXSession {
  <#
  .SYNOPSIS
    Gets and or kills idle Citrix sessions
  .DESCRIPTION
    Gets Citrix session that have been idle for a number of hours specified by a parameter,
    you can choose to kill the sessions or just to report which sessions meet the idle time
    specified.
  .PARAMETER DeliveryController
    This specifies the Citrix Delivery Controller to run the query for the idle session from.
  .PARAMETER IdleHours
    This specifies how many hours the session has been idle for, the default is one hour.
  .PARAMETER KillSessions
    This is a switch parameter that notifies the script that it should be stopping the idle 
    sessions, not just reporting them.
  .EXAMPLE
    Get-IdleHDXSession
    This will show a report of all HDX sessions that have been idle for one hour.
  .EXAMPLE
    Get-IdleHDXSession -IdleHours 2 -DeliveryController NYC-VDC-001 -KillSessions
    This will show a report of all HDX sessions that have been idle for two hours, the session
    query will be done at the server named NYC-VDC-001 and then it will terminate those 
    sessions.
  .INPUTS
    
  .OUTPUTS
    
  .NOTES
    General notes
      Version  : 0.1
      Creator  : Brent Denny
      Date     : 25-Jul-2019
      Modified : 25-Jul-2019
  #>
  [CmdletBinding()]
  Param (
    [int]$IdleHours,
    [string]$DeliveryController = $env:COMPUTERNAME,
    [switch]$KillSessions
  )
  Add-PSSnapin Citrix*
  $IdleTimeSpan = New-TimeSpan -Hours $IdleHours
  $IdleSessions = Get-BrokerSession | Where-Object {$_.IdleDuration -ge $IdleTimeSpan}
  $IdleSessions | Select-Object -Property ApplicationsInUse,MachineName,UserFullName,IdleDuration
  if ($KillSessions -eq $true) {$IdleSessions | Stop-BrokerSession}
}

function Set-PVSModuleToAutoload {
  <#
  .SYNOPSIS
    This allows the PVS module DLL to be autoloaded from the PVS server
  .DESCRIPTION
    This cmdlet creates the user based autoloading directory for the PVS DLL module and copies the 
    DLL into the newly created autoloader directory
  .EXAMPLE
    Set-PVSModuleToAutoload
  .INPUTS

  .OUTPUTS

  .NOTES
    General notes
      Version   : 0.1
      CreatedBy : Brent Denny
      CreatedOn : 26-Jul-2019
      LastEdit  : 26-Jul-2019
  #>
  [cmdletbinding()]
  Param ( )
  if (Test-Path -Path 'C:\Program Files\Citrix\Provisioning Services Console\Citrix.PVS.Snapin.dll') {
    New-Item -ItemType Directory -Name 'Citrix.PVS.Snapin' -Path "$HOME\Documents\WindowsPowershell\modules" -Force
    Copy-Item -Path 'C:\Program Files\Citrix\Provisioning Services Console\Citrix.PVS.Snapin.dll' -Destination $HOME\Documents\WindowsPowershell\modules\Citrix.PVS.Snapin
  }
  else {Write-warning "The PVS Console is not installed on this computer"}
}

function Get-NetScalerInfo {
  <#
  .Synopsis
     This command queries a NetScaler Nitro API
  .DESCRIPTION
     The features that you can query are tab completable from the command line.
     The full API is listed here https://developer-docs.citrix.com/projects/netscaler-nitro-api/en/12.0/
     This command produces a HTML document with the name of NSReport-<datestamp>.html and will place this
     report file in the directory indicated by the HTMLReportDirectory parameter.
  .EXAMPLE
     Get-NetScalerInfo -Config -NSIPAddress '192.168.10.103' -NSConfigElement 'lbvserver' -HTMLReportDirectory c:\logs
     This will look for configuration information from the netscaler, where the NS IPaddress is 
     192.168.10.103 and the element to inspect is lbvserver.
  .EXAMPLE
     Get-NetScalerInfo -Config -NSIPAddress '192.168.10.103' -AllElements -HTMLReportDirectory c:\logs
     This will look for configuration information from all of the Configuaration elements on the NetScaler,
     where the NS IPaddress is 192.168.10.103.
  .EXAMPLE
     Get-NetScalerInfo -Stat -NSStatElement 'interface' -HTMLReportDirectory c:\logs
     This will look for statistics regarding the NS interfaces and will use a default NS IPaddress.
  .NOTES
     General notes
       Created by:  Brent Denny
       Created on:  2 Aug 2019
       Modified on: 6 Aug 2019
  #>
  [cmdletbinding()]
  Param (
    [string]$NSIPAddress = '192.168.10.103',
    [Parameter(ParameterSetName='Config',Mandatory=$true)]
    [switch]$Config,
    [Parameter(ParameterSetName='Config')]
    [switch]$AllElements,
    [Parameter(ParameterSetName='Config')]
    [ValidateSet("Interface","aaacertparams","aaaglobal","aaaglobal_binding","aaaglobal_aaapreauthenticationpolicy_binding","aaaglobal_authenticationnegotiateaction_binding","aaagroup","aaagroup_binding","aaagroup_aaauser_binding","aaagroup_auditnslogpolicy_binding","aaagroup_auditsyslogpolicy_binding","aaagroup_authorizationpolicy_binding","aaagroup_intranetip6_binding","aaagroup_intranetip_binding","aaagroup_tmsessionpolicy_binding","aaagroup_vpnintranetapplication_binding","aaagroup_vpnsessionpolicy_binding","aaagroup_vpntrafficpolicy_binding","aaagroup_vpnurl_binding","aaakcdaccount","aaaldapparams","aaaparameter","aaapreauthenticationaction","aaapreauthenticationparameter","aaapreauthenticationpolicy","aaapreauthenticationpolicy_binding","aaapreauthenticationpolicy_aaaglobal_binding","aaapreauthenticationpolicy_vpnvserver_binding","aaaradiusparams","aaasession","aaatacacsparams","aaauser","aaauser_binding","aaauser_aaagroup_binding","aaauser_auditnslogpolicy_binding","aaauser_auditsyslogpolicy_binding","aaauser_authorizationpolicy_binding","aaauser_intranetip6_binding","aaauser_intranetip_binding","aaauser_tmsessionpolicy_binding","aaauser_vpnintranetapplication_binding","aaauser_vpnsessionpolicy_binding","aaauser_vpntrafficpolicy_binding","aaauser_vpnurl_binding","analyticsprofile","appalgparam","appflowaction","appflowaction_binding","appflowaction_analyticsprofile_binding","appflowcollector","appflowglobal","appflowglobal_binding","appflowglobal_appflowpolicy_binding","appflowparam","appflowpolicy","appflowpolicy_binding","appflowpolicy_appflowglobal_binding","appflowpolicy_appflowpolicylabel_binding","appflowpolicy_csvserver_binding","appflowpolicy_lbvserver_binding","appflowpolicy_vpnvserver_binding","appflowpolicylabel","appflowpolicylabel_binding","appflowpolicylabel_appflowpolicy_binding","appfwarchive","appfwconfidfield","appfwcustomsettings","appfwfieldtype","appfwglobal","appfwglobal_binding","appfwglobal_appfwpolicy_binding","appfwglobal_auditnslogpolicy_binding","appfwglobal_auditsyslogpolicy_binding","appfwhtmlerrorpage","appfwjsoncontenttype","appfwlearningdata","appfwlearningsettings","appfwpolicy","appfwpolicy_binding","appfwpolicy_appfwglobal_binding","appfwpolicy_appfwpolicylabel_binding","appfwpolicy_csvserver_binding","appfwpolicy_lbvserver_binding","appfwpolicylabel","appfwpolicylabel_binding","appfwpolicylabel_appfwpolicy_binding","appfwpolicylabel_policybinding_binding","appfwprofile","appfwprofile_binding","appfwprofile_contenttype_binding","appfwprofile_cookieconsistency_binding","appfwprofile_creditcardnumber_binding","appfwprofile_crosssitescripting_binding","appfwprofile_csrftag_binding","appfwprofile_denyurl_binding","appfwprofile_excluderescontenttype_binding","appfwprofile_fieldconsistency_binding","appfwprofile_fieldformat_binding","appfwprofile_logexpression_binding","appfwprofile_safeobject_binding","appfwprofile_sqlinjection_binding","appfwprofile_starturl_binding","appfwprofile_trustedlearningclients_binding","appfwprofile_xmlattachmenturl_binding","appfwprofile_xmldosurl_binding","appfwprofile_xmlsqlinjection_binding","appfwprofile_xmlvalidationurl_binding","appfwprofile_xmlwsiurl_binding","appfwprofile_xmlxss_binding","appfwsettings","appfwsignatures","appfwtransactionrecords","appfwwsdl","appfwxmlcontenttype","appfwxmlerrorpage","appfwxmlschema","application","appqoeaction","appqoecustomresp","appqoeparameter","appqoepolicy","appqoepolicy_binding","appqoepolicy_lbvserver_binding","arp","arpparam","auditmessageaction","auditmessages","auditnslogaction","auditnslogglobal","auditnslogglobal_binding","auditnslogglobal_auditnslogpolicy_binding","auditnslogparams","auditnslogpolicy","auditnslogpolicy_binding","auditnslogpolicy_aaagroup_binding","auditnslogpolicy_aaauser_binding","auditnslogpolicy_appfwglobal_binding","auditnslogpolicy_auditnslogglobal_binding","auditnslogpolicy_authenticationvserver_binding","auditnslogpolicy_csvserver_binding","auditnslogpolicy_lbvserver_binding","auditnslogpolicy_systemglobal_binding","auditnslogpolicy_tmglobal_binding","auditnslogpolicy_vpnglobal_binding","auditnslogpolicy_vpnvserver_binding","auditsyslogaction","auditsyslogglobal","auditsyslogglobal_binding","auditsyslogglobal_auditsyslogpolicy_binding","auditsyslogparams","auditsyslogpolicy","auditsyslogpolicy_binding","auditsyslogpolicy_aaagroup_binding","auditsyslogpolicy_aaauser_binding","auditsyslogpolicy_auditsyslogglobal_binding","auditsyslogpolicy_authenticationvserver_binding","auditsyslogpolicy_csvserver_binding","auditsyslogpolicy_lbvserver_binding","auditsyslogpolicy_rnatglobal_binding","auditsyslogpolicy_systemglobal_binding","auditsyslogpolicy_tmglobal_binding","auditsyslogpolicy_vpnglobal_binding","auditsyslogpolicy_vpnvserver_binding","authenticationauthnprofile","authenticationazurekeyvault","authenticationcaptchaaction","authenticationcertaction","authenticationcertpolicy","authenticationcertpolicy_binding","authenticationcertpolicy_authenticationvserver_binding","authenticationcertpolicy_vpnglobal_binding","authenticationcertpolicy_vpnvserver_binding","authenticationdfaaction","authenticationdfapolicy","authenticationdfapolicy_binding","authenticationdfapolicy_vpnvserver_binding","authenticationemailaction","authenticationepaaction","authenticationldapaction","authenticationldappolicy","authenticationldappolicy_binding","authenticationldappolicy_authenticationvserver_binding","authenticationldappolicy_systemglobal_binding","authenticationldappolicy_vpnglobal_binding","authenticationldappolicy_vpnvserver_binding","authenticationlocalpolicy","authenticationlocalpolicy_binding","authenticationlocalpolicy_authenticationvserver_binding","authenticationlocalpolicy_systemglobal_binding","authenticationlocalpolicy_vpnglobal_binding","authenticationlocalpolicy_vpnvserver_binding","authenticationloginschema","authenticationloginschemapolicy","authenticationloginschemapolicy_binding","authenticationloginschemapolicy_authenticationvserver_binding","authenticationloginschemapolicy_vpnvserver_binding","authenticationnegotiateaction","authenticationnegotiatepolicy","authenticationnegotiatepolicy_binding","authenticationnegotiatepolicy_authenticationvserver_binding","authenticationnegotiatepolicy_vpnglobal_binding","authenticationnegotiatepolicy_vpnvserver_binding","authenticationnoauthaction","authenticationoauthaction","authenticationoauthidppolicy","authenticationoauthidppolicy_binding","authenticationoauthidppolicy_authenticationvserver_binding","authenticationoauthidppolicy_vpnvserver_binding","authenticationoauthidpprofile","authenticationpolicy","authenticationpolicy_binding","authenticationpolicy_authenticationpolicylabel_binding","authenticationpolicy_authenticationvserver_binding","authenticationpolicy_systemglobal_binding","authenticationpolicylabel","authenticationpolicylabel_binding","authenticationpolicylabel_authenticationpolicy_binding","authenticationpushservice","authenticationradiusaction","authenticationradiuspolicy","authenticationradiuspolicy_binding","authenticationradiuspolicy_authenticationvserver_binding","authenticationradiuspolicy_systemglobal_binding","authenticationradiuspolicy_vpnglobal_binding","authenticationradiuspolicy_vpnvserver_binding","authenticationsamlaction","authenticationsamlidppolicy","authenticationsamlidppolicy_binding","authenticationsamlidppolicy_authenticationvserver_binding","authenticationsamlidppolicy_vpnvserver_binding","authenticationsamlidpprofile","authenticationsamlpolicy","authenticationsamlpolicy_binding","authenticationsamlpolicy_authenticationvserver_binding","authenticationsamlpolicy_vpnglobal_binding","authenticationsamlpolicy_vpnvserver_binding","authenticationstorefrontauthaction","authenticationtacacsaction","authenticationtacacspolicy","authenticationtacacspolicy_binding","authenticationtacacspolicy_authenticationvserver_binding","authenticationtacacspolicy_systemglobal_binding","authenticationtacacspolicy_vpnglobal_binding","authenticationtacacspolicy_vpnvserver_binding","authenticationvserver","authenticationvserver_binding","authenticationvserver_auditnslogpolicy_binding","authenticationvserver_auditsyslogpolicy_binding","authenticationvserver_authenticationcertpolicy_binding","authenticationvserver_authenticationldappolicy_binding","authenticationvserver_authenticationlocalpolicy_binding","authenticationvserver_authenticationloginschemapolicy_binding","authenticationvserver_authenticationnegotiatepolicy_binding","authenticationvserver_authenticationoauthidppolicy_binding","authenticationvserver_authenticationpolicy_binding","authenticationvserver_authenticationradiuspolicy_binding","authenticationvserver_authenticationsamlidppolicy_binding","authenticationvserver_authenticationsamlpolicy_binding","authenticationvserver_authenticationtacacspolicy_binding","authenticationvserver_authenticationwebauthpolicy_binding","authenticationvserver_cspolicy_binding","authenticationvserver_tmsessionpolicy_binding","authenticationvserver_vpnportaltheme_binding","authenticationwebauthaction","authenticationwebauthpolicy","authenticationwebauthpolicy_binding","authenticationwebauthpolicy_authenticationvserver_binding","authenticationwebauthpolicy_systemglobal_binding","authenticationwebauthpolicy_vpnglobal_binding","authenticationwebauthpolicy_vpnvserver_binding","authorizationaction","authorizationpolicy","authorizationpolicy_binding","authorizationpolicy_aaagroup_binding","authorizationpolicy_aaauser_binding","authorizationpolicy_authorizationpolicylabel_binding","authorizationpolicy_csvserver_binding","authorizationpolicy_lbvserver_binding","authorizationpolicylabel","authorizationpolicylabel_binding","authorizationpolicylabel_authorizationpolicy_binding","autoscaleaction","autoscalepolicy","autoscalepolicy_binding","autoscalepolicy_nstimer_binding","autoscaleprofile","bfdsession","bridgegroup","bridgegroup_binding","bridgegroup_nsip6_binding","bridgegroup_nsip_binding","bridgegroup_vlan_binding","bridgetable","caaction","cachecontentgroup","cacheforwardproxy","cacheglobal","cacheglobal_binding","cacheglobal_cachepolicy_binding","cacheobject","cacheparameter","cachepolicy","cachepolicy_binding","cachepolicy_cacheglobal_binding","cachepolicy_cachepolicylabel_binding","cachepolicy_csvserver_binding","cachepolicy_lbvserver_binding","cachepolicylabel","cachepolicylabel_binding","cachepolicylabel_cachepolicy_binding","cachepolicylabel_policybinding_binding","cacheselector","caglobal","caglobal_binding","caglobal_capolicy_binding","callhome","capolicy","capolicy_binding","capolicy_caglobal_binding","capolicy_csvserver_binding","capolicy_lbvserver_binding","channel","channel_binding","channel_interface_binding","ci","cloudautoscalegroup","cloudcredential","cloudparameter","cloudparaminternal","cloudprofile","cloudvserverip","cluster","clusterfiles","clusterinstance","clusterinstance_binding","clusterinstance_clusternode_binding","clusternode","clusternode_binding","clusternode_routemonitor_binding","clusternodegroup","clusternodegroup_binding","clusternodegroup_authenticationvserver_binding","clusternodegroup_clusternode_binding","clusternodegroup_crvserver_binding","clusternodegroup_csvserver_binding","clusternodegroup_gslbsite_binding","clusternodegroup_gslbvserver_binding","clusternodegroup_lbvserver_binding","clusternodegroup_nslimitidentifier_binding","clusternodegroup_service_binding","clusternodegroup_streamidentifier_binding","clusternodegroup_vpnvserver_binding","clusterpropstatus","clustersync","cmpaction","cmpglobal","cmpglobal_binding","cmpglobal_cmppolicy_binding","cmpparameter","cmppolicy","cmppolicy_binding","cmppolicy_cmpglobal_binding","cmppolicy_cmppolicylabel_binding","cmppolicy_crvserver_binding","cmppolicy_csvserver_binding","cmppolicy_lbvserver_binding","cmppolicylabel","cmppolicylabel_binding","cmppolicylabel_cmppolicy_binding","cmppolicylabel_policybinding_binding","contentinspectionaction","contentinspectionglobal","contentinspectionglobal_binding","contentinspectionglobal_contentinspectionpolicy_binding","contentinspectionpolicy","contentinspectionpolicy_binding","contentinspectionpolicy_contentinspectionglobal_binding","contentinspectionpolicy_contentinspectionpolicylabel_binding","contentinspectionpolicy_csvserver_binding","contentinspectionpolicy_lbvserver_binding","contentinspectionpolicylabel","contentinspectionpolicylabel_binding","contentinspectionpolicylabel_contentinspectionpolicy_binding","contentinspectionpolicylabel_policybinding_binding","contentinspectionprofile","craction","crpolicy","crpolicy_binding","crpolicy_crvserver_binding","crvserver","crvserver_binding","crvserver_appflowpolicy_binding","crvserver_appfwpolicy_binding","crvserver_appqoepolicy_binding","crvserver_cachepolicy_binding","crvserver_cmppolicy_binding","crvserver_crpolicy_binding","crvserver_cspolicy_binding","crvserver_feopolicy_binding","crvserver_filterpolicy_binding","crvserver_icapolicy_binding","crvserver_lbvserver_binding","crvserver_policymap_binding","crvserver_responderpolicy_binding","crvserver_rewritepolicy_binding","crvserver_spilloverpolicy_binding","csaction","csparameter","cspolicy","cspolicy_binding","cspolicy_crvserver_binding","cspolicy_cspolicylabel_binding","cspolicy_csvserver_binding","cspolicylabel","cspolicylabel_binding","cspolicylabel_cspolicy_binding","csvserver","csvserver_binding","csvserver_appflowpolicy_binding","csvserver_appfwpolicy_binding","csvserver_appqoepolicy_binding","csvserver_auditnslogpolicy_binding","csvserver_auditsyslogpolicy_binding","csvserver_authorizationpolicy_binding","csvserver_cachepolicy_binding","csvserver_cmppolicy_binding","csvserver_contentinspectionpolicy_binding","csvserver_cspolicy_binding","csvserver_domain_binding","csvserver_feopolicy_binding","csvserver_filterpolicy_binding","csvserver_gslbvserver_binding","csvserver_lbvserver_binding","csvserver_responderpolicy_binding","csvserver_rewritepolicy_binding","csvserver_spilloverpolicy_binding","csvserver_tmtrafficpolicy_binding","csvserver_transformpolicy_binding","csvserver_vpnvserver_binding","dbdbprofile","dbsmonitors","dbuser","dnsaaaarec","dnsaction","dnsaction64","dnsaddrec","dnscnamerec","dnsglobal","dnsglobal_binding","dnsglobal_dnspolicy_binding","dnskey","dnsmxrec","dnsnameserver","dnsnaptrrec","dnsnsecrec","dnsnsrec","dnsparameter","dnspolicy","dnspolicy_binding","dnspolicy64","dnspolicy64_binding","dnspolicy64_lbvserver_binding","dnspolicy_dnsglobal_binding","dnspolicy_dnspolicylabel_binding","dnspolicylabel","dnspolicylabel_binding","dnspolicylabel_dnspolicy_binding","dnspolicylabel_policybinding_binding","dnsprofile","dnsproxyrecords","dnsptrrec","dnssoarec","dnssrvrec","dnssubnetcache","dnssuffix","dnstxtrec","dnsview","dnsview_binding","dnsview_dnspolicy_binding","dnsview_gslbservice_binding","dnszone","dnszone_binding","dnszone_dnskey_binding","dnszone_domain_binding","dospolicy","extendedmemoryparam","feoaction","feoglobal","feoglobal_binding","feoglobal_feopolicy_binding","feoparameter","feopolicy","feopolicy_binding","feopolicy_csvserver_binding","feopolicy_feoglobal_binding","feopolicy_lbvserver_binding","filteraction","filterglobal","filterglobal_binding","filterglobal_filterpolicy_binding","filterhtmlinjectionparameter","filterhtmlinjectionvariable","filterpolicy","filterpolicy_binding","filterpolicy_crvserver_binding","filterpolicy_csvserver_binding","filterpolicy_filterglobal_binding","filterpolicy_lbvserver_binding","filterpostbodyinjection","filterprebodyinjection","fis","fis_binding","fis_channel_binding","fis_interface_binding","forwardingsession","gslbconfig","gslbdomain","gslbdomain_binding","gslbdomain_gslbservice_binding","gslbdomain_gslbservicegroup_binding","gslbdomain_gslbservicegroupmember_binding","gslbdomain_gslbvserver_binding","gslbdomain_lbmonitor_binding","gslbldnsentries","gslbldnsentry","gslbparameter","gslbrunningconfig","gslbservice","gslbservice_binding","gslbservice_dnsview_binding","gslbservice_lbmonitor_binding","gslbservicegroup","gslbservicegroup_binding","gslbservicegroup_gslbservicegroupmember_binding","gslbservicegroup_lbmonitor_binding","gslbservicegroup_servicegroupentitymonbindings_binding","gslbsite","gslbsite_binding","gslbsite_gslbservice_binding","gslbsite_gslbservicegroup_binding","gslbsite_gslbservicegroupmember_binding","gslbsyncstatus","gslbvserver","gslbvserver_binding","gslbvserver_domain_binding","gslbvserver_gslbservice_binding","gslbvserver_gslbservicegroup_binding","gslbvserver_gslbservicegroupmember_binding","gslbvserver_spilloverpolicy_binding","hafailover","hafiles","hanode","hanode_binding","hanode_ci_binding","hanode_fis_binding","hanode_partialfailureinterfaces_binding","hanode_routemonitor6_binding","hanode_routemonitor_binding","hasync","icaaccessprofile","icaaction","icaglobal","icaglobal_binding","icaglobal_icapolicy_binding","icalatencyprofile","icaparameter","icapolicy","icapolicy_binding","icapolicy_crvserver_binding","icapolicy_icaglobal_binding","icapolicy_vpnvserver_binding","inat","inatparam","install","interfacepair","ip6tunnel","ip6tunnelparam","ipsecalgprofile","ipsecalgsession","ipsecparameter","ipsecprofile","ipset","ipset_binding","ipset_nsip6_binding","ipset_nsip_binding","iptunnel","iptunnelparam","ipv6","l2param","l3param","l4param","lacp","lbgroup","lbgroup_binding","lbgroup_lbvserver_binding","lbmetrictable","lbmetrictable_binding","lbmetrictable_metric_binding","lbmonbindings","lbmonbindings_binding","lbmonbindings_gslbservicegroup_binding","lbmonbindings_service_binding","lbmonbindings_servicegroup_binding","lbmonitor","lbmonitor_binding","lbmonitor_metric_binding","lbmonitor_service_binding","lbmonitor_servicegroup_binding","lbmonitor_sslcertkey_binding","lbparameter","lbpersistentsessions","lbprofile","lbroute","lbroute6","lbsipparameters","lbvserver","lbvserver_binding","lbvserver_analyticsprofile_binding","lbvserver_appflowpolicy_binding","lbvserver_appfwpolicy_binding","lbvserver_appqoepolicy_binding","lbvserver_auditnslogpolicy_binding","lbvserver_auditsyslogpolicy_binding","lbvserver_authorizationpolicy_binding","lbvserver_cachepolicy_binding","lbvserver_capolicy_binding","lbvserver_cmppolicy_binding","lbvserver_contentinspectionpolicy_binding","lbvserver_csvserver_binding","lbvserver_dnspolicy64_binding","lbvserver_dospolicy_binding","lbvserver_feopolicy_binding","lbvserver_filterpolicy_binding","lbvserver_pqpolicy_binding","lbvserver_responderpolicy_binding","lbvserver_rewritepolicy_binding","lbvserver_scpolicy_binding","lbvserver_service_binding","lbvserver_servicegroup_binding","lbvserver_servicegroupmember_binding","lbvserver_spilloverpolicy_binding","lbvserver_tmtrafficpolicy_binding","lbvserver_transformpolicy_binding","lbvserver_videooptimizationdetectionpolicy_binding","lbvserver_videooptimizationpacingpolicy_binding","lbwlm","lbwlm_binding","lbwlm_lbvserver_binding","linkset","linkset_binding","linkset_channel_binding","linkset_interface_binding","lldpneighbors","lldpparam","location","locationdata","locationfile","locationfile6","locationparameter","lsnappsprofile","lsnappsprofile_binding","lsnappsprofile_port_binding","lsnclient","lsnclient_binding","lsnclient_network6_binding","lsnclient_network_binding","lsnclient_nsacl6_binding","lsnclient_nsacl_binding","lsndeterministicnat","lsngroup","lsngroup_binding","lsngroup_ipsecalgprofile_binding","lsngroup_lsnappsprofile_binding","lsngroup_lsnhttphdrlogprofile_binding","lsngroup_lsnlogprofile_binding","lsngroup_lsnpool_binding","lsngroup_lsnrtspalgprofile_binding","lsngroup_lsnsipalgprofile_binding","lsngroup_lsntransportprofile_binding","lsngroup_pcpserver_binding","lsnhttphdrlogprofile","lsnip6profile","lsnlogprofile","lsnparameter","lsnpool","lsnpool_binding","lsnpool_lsnip_binding","lsnrtspalgprofile","lsnrtspalgsession","lsnrtspalgsession_binding","lsnrtspalgsession_datachannel_binding","lsnsession","lsnsipalgcall","lsnsipalgcall_binding","lsnsipalgcall_controlchannel_binding","lsnsipalgcall_datachannel_binding","lsnsipalgprofile","lsnstatic","lsntransportprofile","mapbmr","mapbmr_binding","mapbmr_bmrv4network_binding","mapdmr","mapdomain","mapdomain_binding","mapdomain_mapbmr_binding","nat64","nat64param","nd6","nd6ravariables","nd6ravariables_binding","nd6ravariables_onlinkipv6prefix_binding","netbridge","netbridge_binding","netbridge_iptunnel_binding","netbridge_nsip6_binding","netbridge_nsip_binding","netbridge_vlan_binding","netprofile","netprofile_binding","netprofile_natrule_binding","netprofile_srcportset_binding","nsacl","nsacl6","nsacls","nsacls6","nsappflowcollector","nsappflowparam","nsaptlicense","nsassignment","nscapacity","nscentralmanagementserver","nsconfig","nsconnectiontable","nsconsoleloginprompt","nscqaparam","nsdhcpip","nsdhcpparams","nsdiameter","nsencryptionkey","nsencryptionparams","nsevents","nsextension","nsextension_binding","nsextension_extensionfunction_binding","nsfeature","nshardware","nshmackey","nshostname","nshttpparam","nshttpprofile","nsicapprofile","nsip","nsip6","nslicense","nslicenseproxyserver","nslicenseserver","nslicenseserverpool","nslimitidentifier","nslimitidentifier_binding","nslimitidentifier_nslimitsessions_binding","nslimitselector","nslimitsessions","nsmode","nsparam","nspartition","nspartition_binding","nspartition_bridgegroup_binding","nspartition_vlan_binding","nspartition_vxlan_binding","nspartitionmac","nspbr","nspbr6","nspbrs","nsratecontrol","nsrollbackcmd","nsrpcnode","nsrunningconfig","nssavedconfig","nsservicefunction","nsservicepath","nsservicepath_binding","nsservicepath_nsservicefunction_binding","nssimpleacl","nssimpleacl6","nssourceroutecachetable","nsspparams","nsstats","nssurgeq","nstcpbufparam","nstcpparam","nstcpprofile","nstimeout","nstimer","nstimer_binding","nstimer_autoscalepolicy_binding","nstimezone","nstrace","nstrafficdomain","nstrafficdomain_binding","nstrafficdomain_bridgegroup_binding","nstrafficdomain_vlan_binding","nstrafficdomain_vxlan_binding","nsvariable","nsversion","nsvpxparam","nsweblogparam","nsxmlnamespace","ntpparam","ntpserver","ntpstatus","ntpsync","onlinkipv6prefix","pcpmap","pcpprofile","pcpserver","ping","ping6","policydataset","policydataset_binding","policydataset_value_binding","policyevaluation","policyexpression","policyhttpcallout","policymap","policyparam","policypatset","policypatset_binding","policypatset_pattern_binding","policystringmap","policystringmap_binding","policystringmap_pattern_binding","policyurlset","pqbinding","pqpolicy","protocolhttpband","ptp","radiusnode","raid","rdpclientprofile","rdpconnections","rdpserverprofile","reboot","reporting","reputationsettings","responderaction","responderglobal","responderglobal_binding","responderglobal_responderpolicy_binding","responderhtmlpage","responderparam","responderpolicy","responderpolicy_binding","responderpolicy_crvserver_binding","responderpolicy_csvserver_binding","responderpolicy_lbvserver_binding","responderpolicy_responderglobal_binding","responderpolicy_responderpolicylabel_binding","responderpolicylabel","responderpolicylabel_binding","responderpolicylabel_policybinding_binding","responderpolicylabel_responderpolicy_binding","rewriteaction","rewriteglobal","rewriteglobal_binding","rewriteglobal_rewritepolicy_binding","rewriteparam","rewritepolicy","rewritepolicy_binding","rewritepolicy_csvserver_binding","rewritepolicy_lbvserver_binding","rewritepolicy_rewriteglobal_binding","rewritepolicy_rewritepolicylabel_binding","rewritepolicylabel","rewritepolicylabel_binding","rewritepolicylabel_policybinding_binding","rewritepolicylabel_rewritepolicy_binding","riseapbrsvc","riseparam","riseprofile","riseprofile_binding","riseprofile_interface_binding","riserhi","rnat","rnat6","rnat6_binding","rnat6_nsip6_binding","rnatglobal","rnatglobal_binding","rnatglobal_auditsyslogpolicy_binding","rnatparam","rnatsession","route","route6","routerdynamicrouting","rsskeytype","scparameter","scpolicy","server","server_binding","server_gslbservice_binding","server_gslbservicegroup_binding","server_service_binding","server_servicegroup_binding","service","service_binding","service_dospolicy_binding","service_lbmonitor_binding","service_scpolicy_binding","servicegroup","servicegroup_binding","servicegroup_lbmonitor_binding","servicegroup_servicegroupentitymonbindings_binding","servicegroup_servicegroupmember_binding","servicegroupbindings","shutdown","smppparam","smppuser","snmpalarm","snmpcommunity","snmpengineid","snmpgroup","snmpmanager","snmpmib","snmpoid","snmpoption","snmptrap","snmptrap_binding","snmptrap_snmpuser_binding","snmpuser","snmpview","spilloveraction","spilloverpolicy","spilloverpolicy_binding","spilloverpolicy_csvserver_binding","spilloverpolicy_gslbvserver_binding","spilloverpolicy_lbvserver_binding","sslaction","sslcacertgroup","sslcacertgroup_binding","sslcacertgroup_sslcertkey_binding","sslcert","sslcertbundle","sslcertchain","sslcertchain_binding","sslcertchain_sslcertkey_binding","sslcertfile","sslcertkey","sslcertkey_binding","sslcertkey_crldistribution_binding","sslcertkey_service_binding","sslcertkey_sslocspresponder_binding","sslcertkey_sslprofile_binding","sslcertkey_sslvserver_binding","sslcertlink","sslcertreq","sslcipher","sslcipher_binding","sslcipher_individualcipher_binding","sslcipher_service_binding","sslcipher_servicegroup_binding","sslcipher_sslciphersuite_binding","sslcipher_sslprofile_binding","sslcipher_sslvserver_binding","sslciphersuite","sslcrl","sslcrl_binding","sslcrl_serialnumber_binding","sslcrlfile","ssldhfile","ssldhparam","ssldsakey","ssldtlsprofile","sslecdsakey","sslfips","sslfipskey","sslfipssimsource","sslfipssimtarget","sslglobal","sslglobal_binding","sslglobal_sslpolicy_binding","sslhsmkey","sslkeyfile","ssllogprofile","sslocspresponder","sslparameter","sslpkcs12","sslpkcs8","sslpolicy","sslpolicy_binding","sslpolicy_csvserver_binding","sslpolicy_lbvserver_binding","sslpolicy_sslglobal_binding","sslpolicy_sslpolicylabel_binding","sslpolicy_sslservice_binding","sslpolicy_sslvserver_binding","sslpolicylabel","sslpolicylabel_binding","sslpolicylabel_sslpolicy_binding","sslprofile","sslprofile_binding","sslprofile_ecccurve_binding","sslprofile_sslcertkey_binding","sslprofile_sslcipher_binding","sslprofile_sslciphersuite_binding","sslprofile_sslvserver_binding","sslrsakey","sslservice","sslservice_binding","sslservice_ecccurve_binding","sslservice_sslcertkey_binding","sslservice_sslcipher_binding","sslservice_sslciphersuite_binding","sslservice_sslpolicy_binding","sslservicegroup","sslservicegroup_binding","sslservicegroup_ecccurve_binding","sslservicegroup_sslcertkey_binding","sslservicegroup_sslcipher_binding","sslservicegroup_sslciphersuite_binding","sslvserver","sslvserver_binding","sslvserver_ecccurve_binding","sslvserver_sslcertkey_binding","sslvserver_sslcipher_binding","sslvserver_sslciphersuite_binding","sslvserver_sslpolicy_binding","sslwrapkey","streamidentifier","streamidentifier_binding","streamidentifier_streamsession_binding","streamselector","streamsession","subscribergxinterface","subscriberparam","subscriberprofile","subscriberradiusinterface","subscribersessions","svcbindings","systembackup","systemcmdpolicy","systemcollectionparam","systemcore","systemcountergroup","systemcounters","systemdatasource","systementity","systementitydata","systementitytype","systemeventhistory","systemextramgmtcpu","systemfile","systemglobal","systemglobal_binding","systemglobal_auditnslogpolicy_binding","systemglobal_auditsyslogpolicy_binding","systemglobal_authenticationldappolicy_binding","systemglobal_authenticationlocalpolicy_binding","systemglobal_authenticationpolicy_binding","systemglobal_authenticationradiuspolicy_binding","systemglobal_authenticationtacacspolicy_binding","systemglobaldata","systemgroup","systemgroup_binding","systemgroup_nspartition_binding","systemgroup_systemcmdpolicy_binding","systemgroup_systemuser_binding","systemhwerror","systemkek","systemparameter","systemsession","systemsshkey","systemuser","systemuser_binding","systemuser_nspartition_binding","systemuser_systemcmdpolicy_binding","systemuser_systemgroup_binding","techsupport","tmformssoaction","tmglobal","tmglobal_binding","tmglobal_auditnslogpolicy_binding","tmglobal_auditsyslogpolicy_binding","tmglobal_tmsessionpolicy_binding","tmglobal_tmtrafficpolicy_binding","tmsamlssoprofile","tmsessionaction","tmsessionparameter","tmsessionpolicy","tmsessionpolicy_binding","tmsessionpolicy_aaagroup_binding","tmsessionpolicy_aaauser_binding","tmsessionpolicy_authenticationvserver_binding","tmsessionpolicy_tmglobal_binding","tmtrafficaction","tmtrafficpolicy","tmtrafficpolicy_binding","tmtrafficpolicy_csvserver_binding","tmtrafficpolicy_lbvserver_binding","tmtrafficpolicy_tmglobal_binding","traceroute","traceroute6","transformaction","transformglobal","transformglobal_binding","transformglobal_transformpolicy_binding","transformpolicy","transformpolicy_binding","transformpolicy_csvserver_binding","transformpolicy_lbvserver_binding","transformpolicy_transformglobal_binding","transformpolicy_transformpolicylabel_binding","transformpolicylabel","transformpolicylabel_binding","transformpolicylabel_policybinding_binding","transformpolicylabel_transformpolicy_binding","transformprofile","transformprofile_binding","transformprofile_transformaction_binding","tunnelglobal","tunnelglobal_binding","tunnelglobal_tunneltrafficpolicy_binding","tunneltrafficpolicy","tunneltrafficpolicy_binding","tunneltrafficpolicy_tunnelglobal_binding","ulfdserver","urlfilteringcategories","urlfilteringcategorization","urlfilteringcategorygroups","urlfilteringparameter","userprotocol","uservserver","videooptimizationdetectionaction","videooptimizationdetectionpolicy","videooptimizationdetectionpolicy_binding","videooptimizationdetectionpolicy_lbvserver_binding","videooptimizationdetectionpolicy_videooptimizationglobaldetection_binding","videooptimizationdetectionpolicylabel","videooptimizationdetectionpolicylabel_binding","videooptimizationdetectionpolicylabel_policybinding_binding","videooptimizationdetectionpolicylabel_videooptimizationdetectionpolicy_binding","videooptimizationglobaldetection","videooptimizationglobaldetection_binding","videooptimizationglobaldetection_videooptimizationdetectionpolicy_binding","videooptimizationglobalpacing","videooptimizationglobalpacing_binding","videooptimizationglobalpacing_videooptimizationpacingpolicy_binding","videooptimizationpacingaction","videooptimizationpacingpolicy","videooptimizationpacingpolicy_binding","videooptimizationpacingpolicy_lbvserver_binding","videooptimizationpacingpolicy_videooptimizationglobalpacing_binding","videooptimizationpacingpolicylabel","videooptimizationpacingpolicylabel_binding","videooptimizationpacingpolicylabel_policybinding_binding","videooptimizationpacingpolicylabel_videooptimizationpacingpolicy_binding","videooptimizationparameter","vlan","vlan_binding","vlan_channel_binding","vlan_interface_binding","vlan_linkset_binding","vlan_nsip6_binding","vlan_nsip_binding","vpnalwaysonprofile","vpnclientlessaccesspolicy","vpnclientlessaccesspolicy_binding","vpnclientlessaccesspolicy_vpnglobal_binding","vpnclientlessaccesspolicy_vpnvserver_binding","vpnclientlessaccessprofile","vpnepaprofile","vpneula","vpnformssoaction","vpnglobal","vpnglobal_binding","vpnglobal_appcontroller_binding","vpnglobal_auditnslogpolicy_binding","vpnglobal_auditsyslogpolicy_binding","vpnglobal_authenticationcertpolicy_binding","vpnglobal_authenticationldappolicy_binding","vpnglobal_authenticationlocalpolicy_binding","vpnglobal_authenticationnegotiatepolicy_binding","vpnglobal_authenticationpolicy_binding","vpnglobal_authenticationradiuspolicy_binding","vpnglobal_authenticationsamlpolicy_binding","vpnglobal_authenticationtacacspolicy_binding","vpnglobal_domain_binding","vpnglobal_intranetip6_binding","vpnglobal_intranetip_binding","vpnglobal_sharefileserver_binding","vpnglobal_sslcertkey_binding","vpnglobal_staserver_binding","vpnglobal_vpnclientlessaccesspolicy_binding","vpnglobal_vpneula_binding","vpnglobal_vpnintranetapplication_binding","vpnglobal_vpnnexthopserver_binding","vpnglobal_vpnportaltheme_binding","vpnglobal_vpnsessionpolicy_binding","vpnglobal_vpntrafficpolicy_binding","vpnglobal_vpnurl_binding","vpnicaconnection","vpnicadtlsconnection","vpnintranetapplication","vpnnexthopserver","vpnparameter","vpnpcoipconnection","vpnpcoipprofile","vpnpcoipvserverprofile","vpnportaltheme","vpnsamlssoprofile","vpnsessionaction","vpnsessionpolicy","vpnsessionpolicy_binding","vpnsessionpolicy_aaagroup_binding","vpnsessionpolicy_aaauser_binding","vpnsessionpolicy_vpnglobal_binding","vpnsessionpolicy_vpnvserver_binding","vpnsfconfig","vpnstoreinfo","vpntrafficaction","vpntrafficpolicy","vpntrafficpolicy_binding","vpntrafficpolicy_aaagroup_binding","vpntrafficpolicy_aaauser_binding","vpntrafficpolicy_vpnglobal_binding","vpntrafficpolicy_vpnvserver_binding","vpnurl","vpnvserver","vpnvserver_binding","vpnvserver_aaapreauthenticationpolicy_binding","vpnvserver_appcontroller_binding","vpnvserver_appflowpolicy_binding","vpnvserver_auditnslogpolicy_binding","vpnvserver_auditsyslogpolicy_binding","vpnvserver_authenticationcertpolicy_binding","vpnvserver_authenticationdfapolicy_binding","vpnvserver_authenticationldappolicy_binding","vpnvserver_authenticationlocalpolicy_binding","vpnvserver_authenticationloginschemapolicy_binding","vpnvserver_authenticationnegotiatepolicy_binding","vpnvserver_authenticationoauthidppolicy_binding","vpnvserver_authenticationpolicy_binding","vpnvserver_authenticationradiuspolicy_binding","vpnvserver_authenticationsamlidppolicy_binding","vpnvserver_authenticationsamlpolicy_binding","vpnvserver_authenticationtacacspolicy_binding","vpnvserver_authenticationwebauthpolicy_binding","vpnvserver_cachepolicy_binding","vpnvserver_cspolicy_binding","vpnvserver_feopolicy_binding","vpnvserver_icapolicy_binding","vpnvserver_intranetip6_binding","vpnvserver_intranetip_binding","vpnvserver_responderpolicy_binding","vpnvserver_rewritepolicy_binding","vpnvserver_sharefileserver_binding","vpnvserver_staserver_binding","vpnvserver_vpnclientlessaccesspolicy_binding","vpnvserver_vpnepaprofile_binding","vpnvserver_vpneula_binding","vpnvserver_vpnintranetapplication_binding","vpnvserver_vpnnexthopserver_binding","vpnvserver_vpnportaltheme_binding","vpnvserver_vpnsessionpolicy_binding","vpnvserver_vpntrafficpolicy_binding","vpnvserver_vpnurl_binding","vrid","vrid_binding","vrid6","vrid6_binding","vrid6_channel_binding","vrid6_interface_binding","vrid6_nsip6_binding","vrid6_nsip_binding","vrid6_trackinterface_binding","vrid_channel_binding","vrid_interface_binding","vrid_nsip6_binding","vrid_nsip_binding","vrid_trackinterface_binding","vridparam","vserver","vxlan","vxlan_binding","vxlan_iptunnel_binding","vxlan_nsip6_binding","vxlan_nsip_binding","vxlan_srcip_binding","vxlanvlanmap","vxlanvlanmap_binding","vxlanvlanmap_vxlan_binding","wfpackage","wfsite","wipackage","wisite","wisite_binding","wisite_accessmethod_binding","wisite_farmname_binding","wisite_translationinternalip_binding","xmdeployment","xmpackage")]
    [string[]]$NSConfigElement = 'lbvserver',
    [Parameter(ParameterSetName='Stat',Mandatory=$true)]
    [switch]$Stat,
    [Parameter(ParameterSetName='Stat')]
    [validateset("aaa","appflow","appfw","appfwpolicy","appfwpolicylabel","appfwprofile","appqoe","appqoepolicy","audit","authenticationloginschemapolicy","authenticationoauthidppolicy","authenticationpolicy","authenticationpolicylabel","authenticationsamlidppolicy","authenticationvserver","authorizationpolicylabel","autoscalepolicy","bridge","ca","cache","cachecontentgroup","cachepolicy","cachepolicylabel","clusterinstance","clusternode","cmp","cmppolicy","cmppolicylabel","contentinspectionpolicy","contentinspectionpolicylabel","crvserver","csvserver","dns","dnspolicylabel","dnsrecords","dos","dospolicy","feo","gslbdomain","gslbservice","gslbservicegroup","gslbservicegroupmember","gslbsite","gslbvserver","hanode","icapolicy","inat","inatsession","Interface","ipsecalgcounters","ipseccounters","lbvserver","lldp","lsn","lsndslite","lsngroup","lsnnat64","lsnpool","mapbmr","mapdomain","nat64","ns","nsacl","nsacl6","nslimitidentifier","nsmemory","nspartition","nspbr","nspbr6","nssimpleacl","nssimpleacl6","nstrafficdomain","pcpserver","pq","pqpolicy","protocolhttp","protocolicmp","protocolicmpv6","protocolip","protocolipv6","protocolmptcp","protocoltcp","protocoludp","qos","responderpolicy","responderpolicylabel","rewritepolicy","rewritepolicylabel","rnat","rnat6","rnatip","sc","scpolicy","service","servicegroup","servicegroupmember","snmp","spilloverpolicy","ssl","sslvserver","streamidentifier","system","systembw","systemcpu","systemmemory","tmsessionpolicy","tmtrafficpolicy","transformpolicy","transformpolicylabel","tunnelip","tunnelip6","tunneltrafficpolicy","uservserver","videooptimization","videooptimizationdetectionpolicy","videooptimizationdetectionpolicylabel","videooptimizationpacingpolicy","videooptimizationpacingpolicylabel","vlan","vpn","vpnvserver","vxlan")]
    [string[]]$NSStatElement = 'lbvserver',
    [pscredential]$Creds =  (Get-Credential -UserName nsroot -Message "Enter the NS password"),
    [Parameter(Mandatory=$true)]
    [string]$HTMLReportDirectory
  )
  $HtmlFrags = @()
  $CSS = @'
    <style>
      h2 {color:blue;text-align:left;}
      table,th,tr,td {border:2px solid black; border-collapse:collapse;}
      th {background-color:orange;} 
    </style>
'@
  if ($AllElements -eq $true) {
    [string[]]$AllConfigElements = @("Interface","aaacertparams","aaaglobal","aaaglobal_binding","aaaglobal_aaapreauthenticationpolicy_binding","aaaglobal_authenticationnegotiateaction_binding","aaagroup","aaagroup_binding","aaagroup_aaauser_binding","aaagroup_auditnslogpolicy_binding","aaagroup_auditsyslogpolicy_binding","aaagroup_authorizationpolicy_binding","aaagroup_intranetip6_binding","aaagroup_intranetip_binding","aaagroup_tmsessionpolicy_binding","aaagroup_vpnintranetapplication_binding","aaagroup_vpnsessionpolicy_binding","aaagroup_vpntrafficpolicy_binding","aaagroup_vpnurl_binding","aaakcdaccount","aaaldapparams","aaaparameter","aaapreauthenticationaction","aaapreauthenticationparameter","aaapreauthenticationpolicy","aaapreauthenticationpolicy_binding","aaapreauthenticationpolicy_aaaglobal_binding","aaapreauthenticationpolicy_vpnvserver_binding","aaaradiusparams","aaasession","aaatacacsparams","aaauser","aaauser_binding","aaauser_aaagroup_binding","aaauser_auditnslogpolicy_binding","aaauser_auditsyslogpolicy_binding","aaauser_authorizationpolicy_binding","aaauser_intranetip6_binding","aaauser_intranetip_binding","aaauser_tmsessionpolicy_binding","aaauser_vpnintranetapplication_binding","aaauser_vpnsessionpolicy_binding","aaauser_vpntrafficpolicy_binding","aaauser_vpnurl_binding","analyticsprofile","appalgparam","appflowaction","appflowaction_binding","appflowaction_analyticsprofile_binding","appflowcollector","appflowglobal","appflowglobal_binding","appflowglobal_appflowpolicy_binding","appflowparam","appflowpolicy","appflowpolicy_binding","appflowpolicy_appflowglobal_binding","appflowpolicy_appflowpolicylabel_binding","appflowpolicy_csvserver_binding","appflowpolicy_lbvserver_binding","appflowpolicy_vpnvserver_binding","appflowpolicylabel","appflowpolicylabel_binding","appflowpolicylabel_appflowpolicy_binding","appfwarchive","appfwconfidfield","appfwcustomsettings","appfwfieldtype","appfwglobal","appfwglobal_binding","appfwglobal_appfwpolicy_binding","appfwglobal_auditnslogpolicy_binding","appfwglobal_auditsyslogpolicy_binding","appfwhtmlerrorpage","appfwjsoncontenttype","appfwlearningdata","appfwlearningsettings","appfwpolicy","appfwpolicy_binding","appfwpolicy_appfwglobal_binding","appfwpolicy_appfwpolicylabel_binding","appfwpolicy_csvserver_binding","appfwpolicy_lbvserver_binding","appfwpolicylabel","appfwpolicylabel_binding","appfwpolicylabel_appfwpolicy_binding","appfwpolicylabel_policybinding_binding","appfwprofile","appfwprofile_binding","appfwprofile_contenttype_binding","appfwprofile_cookieconsistency_binding","appfwprofile_creditcardnumber_binding","appfwprofile_crosssitescripting_binding","appfwprofile_csrftag_binding","appfwprofile_denyurl_binding","appfwprofile_excluderescontenttype_binding","appfwprofile_fieldconsistency_binding","appfwprofile_fieldformat_binding","appfwprofile_logexpression_binding","appfwprofile_safeobject_binding","appfwprofile_sqlinjection_binding","appfwprofile_starturl_binding","appfwprofile_trustedlearningclients_binding","appfwprofile_xmlattachmenturl_binding","appfwprofile_xmldosurl_binding","appfwprofile_xmlsqlinjection_binding","appfwprofile_xmlvalidationurl_binding","appfwprofile_xmlwsiurl_binding","appfwprofile_xmlxss_binding","appfwsettings","appfwsignatures","appfwtransactionrecords","appfwwsdl","appfwxmlcontenttype","appfwxmlerrorpage","appfwxmlschema","application","appqoeaction","appqoecustomresp","appqoeparameter","appqoepolicy","appqoepolicy_binding","appqoepolicy_lbvserver_binding","arp","arpparam","auditmessageaction","auditmessages","auditnslogaction","auditnslogglobal","auditnslogglobal_binding","auditnslogglobal_auditnslogpolicy_binding","auditnslogparams","auditnslogpolicy","auditnslogpolicy_binding","auditnslogpolicy_aaagroup_binding","auditnslogpolicy_aaauser_binding","auditnslogpolicy_appfwglobal_binding","auditnslogpolicy_auditnslogglobal_binding","auditnslogpolicy_authenticationvserver_binding","auditnslogpolicy_csvserver_binding","auditnslogpolicy_lbvserver_binding","auditnslogpolicy_systemglobal_binding","auditnslogpolicy_tmglobal_binding","auditnslogpolicy_vpnglobal_binding","auditnslogpolicy_vpnvserver_binding","auditsyslogaction","auditsyslogglobal","auditsyslogglobal_binding","auditsyslogglobal_auditsyslogpolicy_binding","auditsyslogparams","auditsyslogpolicy","auditsyslogpolicy_binding","auditsyslogpolicy_aaagroup_binding","auditsyslogpolicy_aaauser_binding","auditsyslogpolicy_auditsyslogglobal_binding","auditsyslogpolicy_authenticationvserver_binding","auditsyslogpolicy_csvserver_binding","auditsyslogpolicy_lbvserver_binding","auditsyslogpolicy_rnatglobal_binding","auditsyslogpolicy_systemglobal_binding","auditsyslogpolicy_tmglobal_binding","auditsyslogpolicy_vpnglobal_binding","auditsyslogpolicy_vpnvserver_binding","authenticationauthnprofile","authenticationazurekeyvault","authenticationcaptchaaction","authenticationcertaction","authenticationcertpolicy","authenticationcertpolicy_binding","authenticationcertpolicy_authenticationvserver_binding","authenticationcertpolicy_vpnglobal_binding","authenticationcertpolicy_vpnvserver_binding","authenticationdfaaction","authenticationdfapolicy","authenticationdfapolicy_binding","authenticationdfapolicy_vpnvserver_binding","authenticationemailaction","authenticationepaaction","authenticationldapaction","authenticationldappolicy","authenticationldappolicy_binding","authenticationldappolicy_authenticationvserver_binding","authenticationldappolicy_systemglobal_binding","authenticationldappolicy_vpnglobal_binding","authenticationldappolicy_vpnvserver_binding","authenticationlocalpolicy","authenticationlocalpolicy_binding","authenticationlocalpolicy_authenticationvserver_binding","authenticationlocalpolicy_systemglobal_binding","authenticationlocalpolicy_vpnglobal_binding","authenticationlocalpolicy_vpnvserver_binding","authenticationloginschema","authenticationloginschemapolicy","authenticationloginschemapolicy_binding","authenticationloginschemapolicy_authenticationvserver_binding","authenticationloginschemapolicy_vpnvserver_binding","authenticationnegotiateaction","authenticationnegotiatepolicy","authenticationnegotiatepolicy_binding","authenticationnegotiatepolicy_authenticationvserver_binding","authenticationnegotiatepolicy_vpnglobal_binding","authenticationnegotiatepolicy_vpnvserver_binding","authenticationnoauthaction","authenticationoauthaction","authenticationoauthidppolicy","authenticationoauthidppolicy_binding","authenticationoauthidppolicy_authenticationvserver_binding","authenticationoauthidppolicy_vpnvserver_binding","authenticationoauthidpprofile","authenticationpolicy","authenticationpolicy_binding","authenticationpolicy_authenticationpolicylabel_binding","authenticationpolicy_authenticationvserver_binding","authenticationpolicy_systemglobal_binding","authenticationpolicylabel","authenticationpolicylabel_binding","authenticationpolicylabel_authenticationpolicy_binding","authenticationpushservice","authenticationradiusaction","authenticationradiuspolicy","authenticationradiuspolicy_binding","authenticationradiuspolicy_authenticationvserver_binding","authenticationradiuspolicy_systemglobal_binding","authenticationradiuspolicy_vpnglobal_binding","authenticationradiuspolicy_vpnvserver_binding","authenticationsamlaction","authenticationsamlidppolicy","authenticationsamlidppolicy_binding","authenticationsamlidppolicy_authenticationvserver_binding","authenticationsamlidppolicy_vpnvserver_binding","authenticationsamlidpprofile","authenticationsamlpolicy","authenticationsamlpolicy_binding","authenticationsamlpolicy_authenticationvserver_binding","authenticationsamlpolicy_vpnglobal_binding","authenticationsamlpolicy_vpnvserver_binding","authenticationstorefrontauthaction","authenticationtacacsaction","authenticationtacacspolicy","authenticationtacacspolicy_binding","authenticationtacacspolicy_authenticationvserver_binding","authenticationtacacspolicy_systemglobal_binding","authenticationtacacspolicy_vpnglobal_binding","authenticationtacacspolicy_vpnvserver_binding","authenticationvserver","authenticationvserver_binding","authenticationvserver_auditnslogpolicy_binding","authenticationvserver_auditsyslogpolicy_binding","authenticationvserver_authenticationcertpolicy_binding","authenticationvserver_authenticationldappolicy_binding","authenticationvserver_authenticationlocalpolicy_binding","authenticationvserver_authenticationloginschemapolicy_binding","authenticationvserver_authenticationnegotiatepolicy_binding","authenticationvserver_authenticationoauthidppolicy_binding","authenticationvserver_authenticationpolicy_binding","authenticationvserver_authenticationradiuspolicy_binding","authenticationvserver_authenticationsamlidppolicy_binding","authenticationvserver_authenticationsamlpolicy_binding","authenticationvserver_authenticationtacacspolicy_binding","authenticationvserver_authenticationwebauthpolicy_binding","authenticationvserver_cspolicy_binding","authenticationvserver_tmsessionpolicy_binding","authenticationvserver_vpnportaltheme_binding","authenticationwebauthaction","authenticationwebauthpolicy","authenticationwebauthpolicy_binding","authenticationwebauthpolicy_authenticationvserver_binding","authenticationwebauthpolicy_systemglobal_binding","authenticationwebauthpolicy_vpnglobal_binding","authenticationwebauthpolicy_vpnvserver_binding","authorizationaction","authorizationpolicy","authorizationpolicy_binding","authorizationpolicy_aaagroup_binding","authorizationpolicy_aaauser_binding","authorizationpolicy_authorizationpolicylabel_binding","authorizationpolicy_csvserver_binding","authorizationpolicy_lbvserver_binding","authorizationpolicylabel","authorizationpolicylabel_binding","authorizationpolicylabel_authorizationpolicy_binding","autoscaleaction","autoscalepolicy","autoscalepolicy_binding","autoscalepolicy_nstimer_binding","autoscaleprofile","bfdsession","bridgegroup","bridgegroup_binding","bridgegroup_nsip6_binding","bridgegroup_nsip_binding","bridgegroup_vlan_binding","bridgetable","caaction","cachecontentgroup","cacheforwardproxy","cacheglobal","cacheglobal_binding","cacheglobal_cachepolicy_binding","cacheobject","cacheparameter","cachepolicy","cachepolicy_binding","cachepolicy_cacheglobal_binding","cachepolicy_cachepolicylabel_binding","cachepolicy_csvserver_binding","cachepolicy_lbvserver_binding","cachepolicylabel","cachepolicylabel_binding","cachepolicylabel_cachepolicy_binding","cachepolicylabel_policybinding_binding","cacheselector","caglobal","caglobal_binding","caglobal_capolicy_binding","callhome","capolicy","capolicy_binding","capolicy_caglobal_binding","capolicy_csvserver_binding","capolicy_lbvserver_binding","channel","channel_binding","channel_interface_binding","ci","cloudautoscalegroup","cloudcredential","cloudparameter","cloudparaminternal","cloudprofile","cloudvserverip","cluster","clusterfiles","clusterinstance","clusterinstance_binding","clusterinstance_clusternode_binding","clusternode","clusternode_binding","clusternode_routemonitor_binding","clusternodegroup","clusternodegroup_binding","clusternodegroup_authenticationvserver_binding","clusternodegroup_clusternode_binding","clusternodegroup_crvserver_binding","clusternodegroup_csvserver_binding","clusternodegroup_gslbsite_binding","clusternodegroup_gslbvserver_binding","clusternodegroup_lbvserver_binding","clusternodegroup_nslimitidentifier_binding","clusternodegroup_service_binding","clusternodegroup_streamidentifier_binding","clusternodegroup_vpnvserver_binding","clusterpropstatus","clustersync","cmpaction","cmpglobal","cmpglobal_binding","cmpglobal_cmppolicy_binding","cmpparameter","cmppolicy","cmppolicy_binding","cmppolicy_cmpglobal_binding","cmppolicy_cmppolicylabel_binding","cmppolicy_crvserver_binding","cmppolicy_csvserver_binding","cmppolicy_lbvserver_binding","cmppolicylabel","cmppolicylabel_binding","cmppolicylabel_cmppolicy_binding","cmppolicylabel_policybinding_binding","contentinspectionaction","contentinspectionglobal","contentinspectionglobal_binding","contentinspectionglobal_contentinspectionpolicy_binding","contentinspectionpolicy","contentinspectionpolicy_binding","contentinspectionpolicy_contentinspectionglobal_binding","contentinspectionpolicy_contentinspectionpolicylabel_binding","contentinspectionpolicy_csvserver_binding","contentinspectionpolicy_lbvserver_binding","contentinspectionpolicylabel","contentinspectionpolicylabel_binding","contentinspectionpolicylabel_contentinspectionpolicy_binding","contentinspectionpolicylabel_policybinding_binding","contentinspectionprofile","craction","crpolicy","crpolicy_binding","crpolicy_crvserver_binding","crvserver","crvserver_binding","crvserver_appflowpolicy_binding","crvserver_appfwpolicy_binding","crvserver_appqoepolicy_binding","crvserver_cachepolicy_binding","crvserver_cmppolicy_binding","crvserver_crpolicy_binding","crvserver_cspolicy_binding","crvserver_feopolicy_binding","crvserver_filterpolicy_binding","crvserver_icapolicy_binding","crvserver_lbvserver_binding","crvserver_policymap_binding","crvserver_responderpolicy_binding","crvserver_rewritepolicy_binding","crvserver_spilloverpolicy_binding","csaction","csparameter","cspolicy","cspolicy_binding","cspolicy_crvserver_binding","cspolicy_cspolicylabel_binding","cspolicy_csvserver_binding","cspolicylabel","cspolicylabel_binding","cspolicylabel_cspolicy_binding","csvserver","csvserver_binding","csvserver_appflowpolicy_binding","csvserver_appfwpolicy_binding","csvserver_appqoepolicy_binding","csvserver_auditnslogpolicy_binding","csvserver_auditsyslogpolicy_binding","csvserver_authorizationpolicy_binding","csvserver_cachepolicy_binding","csvserver_cmppolicy_binding","csvserver_contentinspectionpolicy_binding","csvserver_cspolicy_binding","csvserver_domain_binding","csvserver_feopolicy_binding","csvserver_filterpolicy_binding","csvserver_gslbvserver_binding","csvserver_lbvserver_binding","csvserver_responderpolicy_binding","csvserver_rewritepolicy_binding","csvserver_spilloverpolicy_binding","csvserver_tmtrafficpolicy_binding","csvserver_transformpolicy_binding","csvserver_vpnvserver_binding","dbdbprofile","dbsmonitors","dbuser","dnsaaaarec","dnsaction","dnsaction64","dnsaddrec","dnscnamerec","dnsglobal","dnsglobal_binding","dnsglobal_dnspolicy_binding","dnskey","dnsmxrec","dnsnameserver","dnsnaptrrec","dnsnsecrec","dnsnsrec","dnsparameter","dnspolicy","dnspolicy_binding","dnspolicy64","dnspolicy64_binding","dnspolicy64_lbvserver_binding","dnspolicy_dnsglobal_binding","dnspolicy_dnspolicylabel_binding","dnspolicylabel","dnspolicylabel_binding","dnspolicylabel_dnspolicy_binding","dnspolicylabel_policybinding_binding","dnsprofile","dnsproxyrecords","dnsptrrec","dnssoarec","dnssrvrec","dnssubnetcache","dnssuffix","dnstxtrec","dnsview","dnsview_binding","dnsview_dnspolicy_binding","dnsview_gslbservice_binding","dnszone","dnszone_binding","dnszone_dnskey_binding","dnszone_domain_binding","dospolicy","extendedmemoryparam","feoaction","feoglobal","feoglobal_binding","feoglobal_feopolicy_binding","feoparameter","feopolicy","feopolicy_binding","feopolicy_csvserver_binding","feopolicy_feoglobal_binding","feopolicy_lbvserver_binding","filteraction","filterglobal","filterglobal_binding","filterglobal_filterpolicy_binding","filterhtmlinjectionparameter","filterhtmlinjectionvariable","filterpolicy","filterpolicy_binding","filterpolicy_crvserver_binding","filterpolicy_csvserver_binding","filterpolicy_filterglobal_binding","filterpolicy_lbvserver_binding","filterpostbodyinjection","filterprebodyinjection","fis","fis_binding","fis_channel_binding","fis_interface_binding","forwardingsession","gslbconfig","gslbdomain","gslbdomain_binding","gslbdomain_gslbservice_binding","gslbdomain_gslbservicegroup_binding","gslbdomain_gslbservicegroupmember_binding","gslbdomain_gslbvserver_binding","gslbdomain_lbmonitor_binding","gslbldnsentries","gslbldnsentry","gslbparameter","gslbrunningconfig","gslbservice","gslbservice_binding","gslbservice_dnsview_binding","gslbservice_lbmonitor_binding","gslbservicegroup","gslbservicegroup_binding","gslbservicegroup_gslbservicegroupmember_binding","gslbservicegroup_lbmonitor_binding","gslbservicegroup_servicegroupentitymonbindings_binding","gslbsite","gslbsite_binding","gslbsite_gslbservice_binding","gslbsite_gslbservicegroup_binding","gslbsite_gslbservicegroupmember_binding","gslbsyncstatus","gslbvserver","gslbvserver_binding","gslbvserver_domain_binding","gslbvserver_gslbservice_binding","gslbvserver_gslbservicegroup_binding","gslbvserver_gslbservicegroupmember_binding","gslbvserver_spilloverpolicy_binding","hafailover","hafiles","hanode","hanode_binding","hanode_ci_binding","hanode_fis_binding","hanode_partialfailureinterfaces_binding","hanode_routemonitor6_binding","hanode_routemonitor_binding","hasync","icaaccessprofile","icaaction","icaglobal","icaglobal_binding","icaglobal_icapolicy_binding","icalatencyprofile","icaparameter","icapolicy","icapolicy_binding","icapolicy_crvserver_binding","icapolicy_icaglobal_binding","icapolicy_vpnvserver_binding","inat","inatparam","install","interfacepair","ip6tunnel","ip6tunnelparam","ipsecalgprofile","ipsecalgsession","ipsecparameter","ipsecprofile","ipset","ipset_binding","ipset_nsip6_binding","ipset_nsip_binding","iptunnel","iptunnelparam","ipv6","l2param","l3param","l4param","lacp","lbgroup","lbgroup_binding","lbgroup_lbvserver_binding","lbmetrictable","lbmetrictable_binding","lbmetrictable_metric_binding","lbmonbindings","lbmonbindings_binding","lbmonbindings_gslbservicegroup_binding","lbmonbindings_service_binding","lbmonbindings_servicegroup_binding","lbmonitor","lbmonitor_binding","lbmonitor_metric_binding","lbmonitor_service_binding","lbmonitor_servicegroup_binding","lbmonitor_sslcertkey_binding","lbparameter","lbpersistentsessions","lbprofile","lbroute","lbroute6","lbsipparameters","lbvserver","lbvserver_binding","lbvserver_analyticsprofile_binding","lbvserver_appflowpolicy_binding","lbvserver_appfwpolicy_binding","lbvserver_appqoepolicy_binding","lbvserver_auditnslogpolicy_binding","lbvserver_auditsyslogpolicy_binding","lbvserver_authorizationpolicy_binding","lbvserver_cachepolicy_binding","lbvserver_capolicy_binding","lbvserver_cmppolicy_binding","lbvserver_contentinspectionpolicy_binding","lbvserver_csvserver_binding","lbvserver_dnspolicy64_binding","lbvserver_dospolicy_binding","lbvserver_feopolicy_binding","lbvserver_filterpolicy_binding","lbvserver_pqpolicy_binding","lbvserver_responderpolicy_binding","lbvserver_rewritepolicy_binding","lbvserver_scpolicy_binding","lbvserver_service_binding","lbvserver_servicegroup_binding","lbvserver_servicegroupmember_binding","lbvserver_spilloverpolicy_binding","lbvserver_tmtrafficpolicy_binding","lbvserver_transformpolicy_binding","lbvserver_videooptimizationdetectionpolicy_binding","lbvserver_videooptimizationpacingpolicy_binding","lbwlm","lbwlm_binding","lbwlm_lbvserver_binding","linkset","linkset_binding","linkset_channel_binding","linkset_interface_binding","lldpneighbors","lldpparam","location","locationdata","locationfile","locationfile6","locationparameter","lsnappsprofile","lsnappsprofile_binding","lsnappsprofile_port_binding","lsnclient","lsnclient_binding","lsnclient_network6_binding","lsnclient_network_binding","lsnclient_nsacl6_binding","lsnclient_nsacl_binding","lsndeterministicnat","lsngroup","lsngroup_binding","lsngroup_ipsecalgprofile_binding","lsngroup_lsnappsprofile_binding","lsngroup_lsnhttphdrlogprofile_binding","lsngroup_lsnlogprofile_binding","lsngroup_lsnpool_binding","lsngroup_lsnrtspalgprofile_binding","lsngroup_lsnsipalgprofile_binding","lsngroup_lsntransportprofile_binding","lsngroup_pcpserver_binding","lsnhttphdrlogprofile","lsnip6profile","lsnlogprofile","lsnparameter","lsnpool","lsnpool_binding","lsnpool_lsnip_binding","lsnrtspalgprofile","lsnrtspalgsession","lsnrtspalgsession_binding","lsnrtspalgsession_datachannel_binding","lsnsession","lsnsipalgcall","lsnsipalgcall_binding","lsnsipalgcall_controlchannel_binding","lsnsipalgcall_datachannel_binding","lsnsipalgprofile","lsnstatic","lsntransportprofile","mapbmr","mapbmr_binding","mapbmr_bmrv4network_binding","mapdmr","mapdomain","mapdomain_binding","mapdomain_mapbmr_binding","nat64","nat64param","nd6","nd6ravariables","nd6ravariables_binding","nd6ravariables_onlinkipv6prefix_binding","netbridge","netbridge_binding","netbridge_iptunnel_binding","netbridge_nsip6_binding","netbridge_nsip_binding","netbridge_vlan_binding","netprofile","netprofile_binding","netprofile_natrule_binding","netprofile_srcportset_binding","nsacl","nsacl6","nsacls","nsacls6","nsappflowcollector","nsappflowparam","nsaptlicense","nsassignment","nscapacity","nscentralmanagementserver","nsconfig","nsconnectiontable","nsconsoleloginprompt","nscqaparam","nsdhcpip","nsdhcpparams","nsdiameter","nsencryptionkey","nsencryptionparams","nsevents","nsextension","nsextension_binding","nsextension_extensionfunction_binding","nsfeature","nshardware","nshmackey","nshostname","nshttpparam","nshttpprofile","nsicapprofile","nsip","nsip6","nslicense","nslicenseproxyserver","nslicenseserver","nslicenseserverpool","nslimitidentifier","nslimitidentifier_binding","nslimitidentifier_nslimitsessions_binding","nslimitselector","nslimitsessions","nsmode","nsparam","nspartition","nspartition_binding","nspartition_bridgegroup_binding","nspartition_vlan_binding","nspartition_vxlan_binding","nspartitionmac","nspbr","nspbr6","nspbrs","nsratecontrol","nsrollbackcmd","nsrpcnode","nsrunningconfig","nssavedconfig","nsservicefunction","nsservicepath","nsservicepath_binding","nsservicepath_nsservicefunction_binding","nssimpleacl","nssimpleacl6","nssourceroutecachetable","nsspparams","nsstats","nssurgeq","nstcpbufparam","nstcpparam","nstcpprofile","nstimeout","nstimer","nstimer_binding","nstimer_autoscalepolicy_binding","nstimezone","nstrace","nstrafficdomain","nstrafficdomain_binding","nstrafficdomain_bridgegroup_binding","nstrafficdomain_vlan_binding","nstrafficdomain_vxlan_binding","nsvariable","nsversion","nsvpxparam","nsweblogparam","nsxmlnamespace","ntpparam","ntpserver","ntpstatus","ntpsync","onlinkipv6prefix","pcpmap","pcpprofile","pcpserver","ping","ping6","policydataset","policydataset_binding","policydataset_value_binding","policyevaluation","policyexpression","policyhttpcallout","policymap","policyparam","policypatset","policypatset_binding","policypatset_pattern_binding","policystringmap","policystringmap_binding","policystringmap_pattern_binding","policyurlset","pqbinding","pqpolicy","protocolhttpband","ptp","radiusnode","raid","rdpclientprofile","rdpconnections","rdpserverprofile","reboot","reporting","reputationsettings","responderaction","responderglobal","responderglobal_binding","responderglobal_responderpolicy_binding","responderhtmlpage","responderparam","responderpolicy","responderpolicy_binding","responderpolicy_crvserver_binding","responderpolicy_csvserver_binding","responderpolicy_lbvserver_binding","responderpolicy_responderglobal_binding","responderpolicy_responderpolicylabel_binding","responderpolicylabel","responderpolicylabel_binding","responderpolicylabel_policybinding_binding","responderpolicylabel_responderpolicy_binding","rewriteaction","rewriteglobal","rewriteglobal_binding","rewriteglobal_rewritepolicy_binding","rewriteparam","rewritepolicy","rewritepolicy_binding","rewritepolicy_csvserver_binding","rewritepolicy_lbvserver_binding","rewritepolicy_rewriteglobal_binding","rewritepolicy_rewritepolicylabel_binding","rewritepolicylabel","rewritepolicylabel_binding","rewritepolicylabel_policybinding_binding","rewritepolicylabel_rewritepolicy_binding","riseapbrsvc","riseparam","riseprofile","riseprofile_binding","riseprofile_interface_binding","riserhi","rnat","rnat6","rnat6_binding","rnat6_nsip6_binding","rnatglobal","rnatglobal_binding","rnatglobal_auditsyslogpolicy_binding","rnatparam","rnatsession","route","route6","routerdynamicrouting","rsskeytype","scparameter","scpolicy","server","server_binding","server_gslbservice_binding","server_gslbservicegroup_binding","server_service_binding","server_servicegroup_binding","service","service_binding","service_dospolicy_binding","service_lbmonitor_binding","service_scpolicy_binding","servicegroup","servicegroup_binding","servicegroup_lbmonitor_binding","servicegroup_servicegroupentitymonbindings_binding","servicegroup_servicegroupmember_binding","servicegroupbindings","shutdown","smppparam","smppuser","snmpalarm","snmpcommunity","snmpengineid","snmpgroup","snmpmanager","snmpmib","snmpoid","snmpoption","snmptrap","snmptrap_binding","snmptrap_snmpuser_binding","snmpuser","snmpview","spilloveraction","spilloverpolicy","spilloverpolicy_binding","spilloverpolicy_csvserver_binding","spilloverpolicy_gslbvserver_binding","spilloverpolicy_lbvserver_binding","sslaction","sslcacertgroup","sslcacertgroup_binding","sslcacertgroup_sslcertkey_binding","sslcert","sslcertbundle","sslcertchain","sslcertchain_binding","sslcertchain_sslcertkey_binding","sslcertfile","sslcertkey","sslcertkey_binding","sslcertkey_crldistribution_binding","sslcertkey_service_binding","sslcertkey_sslocspresponder_binding","sslcertkey_sslprofile_binding","sslcertkey_sslvserver_binding","sslcertlink","sslcertreq","sslcipher","sslcipher_binding","sslcipher_individualcipher_binding","sslcipher_service_binding","sslcipher_servicegroup_binding","sslcipher_sslciphersuite_binding","sslcipher_sslprofile_binding","sslcipher_sslvserver_binding","sslciphersuite","sslcrl","sslcrl_binding","sslcrl_serialnumber_binding","sslcrlfile","ssldhfile","ssldhparam","ssldsakey","ssldtlsprofile","sslecdsakey","sslfips","sslfipskey","sslfipssimsource","sslfipssimtarget","sslglobal","sslglobal_binding","sslglobal_sslpolicy_binding","sslhsmkey","sslkeyfile","ssllogprofile","sslocspresponder","sslparameter","sslpkcs12","sslpkcs8","sslpolicy","sslpolicy_binding","sslpolicy_csvserver_binding","sslpolicy_lbvserver_binding","sslpolicy_sslglobal_binding","sslpolicy_sslpolicylabel_binding","sslpolicy_sslservice_binding","sslpolicy_sslvserver_binding","sslpolicylabel","sslpolicylabel_binding","sslpolicylabel_sslpolicy_binding","sslprofile","sslprofile_binding","sslprofile_ecccurve_binding","sslprofile_sslcertkey_binding","sslprofile_sslcipher_binding","sslprofile_sslciphersuite_binding","sslprofile_sslvserver_binding","sslrsakey","sslservice","sslservice_binding","sslservice_ecccurve_binding","sslservice_sslcertkey_binding","sslservice_sslcipher_binding","sslservice_sslciphersuite_binding","sslservice_sslpolicy_binding","sslservicegroup","sslservicegroup_binding","sslservicegroup_ecccurve_binding","sslservicegroup_sslcertkey_binding","sslservicegroup_sslcipher_binding","sslservicegroup_sslciphersuite_binding","sslvserver","sslvserver_binding","sslvserver_ecccurve_binding","sslvserver_sslcertkey_binding","sslvserver_sslcipher_binding","sslvserver_sslciphersuite_binding","sslvserver_sslpolicy_binding","sslwrapkey","streamidentifier","streamidentifier_binding","streamidentifier_streamsession_binding","streamselector","streamsession","subscribergxinterface","subscriberparam","subscriberprofile","subscriberradiusinterface","subscribersessions","svcbindings","systembackup","systemcmdpolicy","systemcollectionparam","systemcore","systemcountergroup","systemcounters","systemdatasource","systementity","systementitydata","systementitytype","systemeventhistory","systemextramgmtcpu","systemfile","systemglobal","systemglobal_binding","systemglobal_auditnslogpolicy_binding","systemglobal_auditsyslogpolicy_binding","systemglobal_authenticationldappolicy_binding","systemglobal_authenticationlocalpolicy_binding","systemglobal_authenticationpolicy_binding","systemglobal_authenticationradiuspolicy_binding","systemglobal_authenticationtacacspolicy_binding","systemglobaldata","systemgroup","systemgroup_binding","systemgroup_nspartition_binding","systemgroup_systemcmdpolicy_binding","systemgroup_systemuser_binding","systemhwerror","systemkek","systemparameter","systemsession","systemsshkey","systemuser","systemuser_binding","systemuser_nspartition_binding","systemuser_systemcmdpolicy_binding","systemuser_systemgroup_binding","techsupport","tmformssoaction","tmglobal","tmglobal_binding","tmglobal_auditnslogpolicy_binding","tmglobal_auditsyslogpolicy_binding","tmglobal_tmsessionpolicy_binding","tmglobal_tmtrafficpolicy_binding","tmsamlssoprofile","tmsessionaction","tmsessionparameter","tmsessionpolicy","tmsessionpolicy_binding","tmsessionpolicy_aaagroup_binding","tmsessionpolicy_aaauser_binding","tmsessionpolicy_authenticationvserver_binding","tmsessionpolicy_tmglobal_binding","tmtrafficaction","tmtrafficpolicy","tmtrafficpolicy_binding","tmtrafficpolicy_csvserver_binding","tmtrafficpolicy_lbvserver_binding","tmtrafficpolicy_tmglobal_binding","traceroute","traceroute6","transformaction","transformglobal","transformglobal_binding","transformglobal_transformpolicy_binding","transformpolicy","transformpolicy_binding","transformpolicy_csvserver_binding","transformpolicy_lbvserver_binding","transformpolicy_transformglobal_binding","transformpolicy_transformpolicylabel_binding","transformpolicylabel","transformpolicylabel_binding","transformpolicylabel_policybinding_binding","transformpolicylabel_transformpolicy_binding","transformprofile","transformprofile_binding","transformprofile_transformaction_binding","tunnelglobal","tunnelglobal_binding","tunnelglobal_tunneltrafficpolicy_binding","tunneltrafficpolicy","tunneltrafficpolicy_binding","tunneltrafficpolicy_tunnelglobal_binding","ulfdserver","urlfilteringcategories","urlfilteringcategorization","urlfilteringcategorygroups","urlfilteringparameter","userprotocol","uservserver","videooptimizationdetectionaction","videooptimizationdetectionpolicy","videooptimizationdetectionpolicy_binding","videooptimizationdetectionpolicy_lbvserver_binding","videooptimizationdetectionpolicy_videooptimizationglobaldetection_binding","videooptimizationdetectionpolicylabel","videooptimizationdetectionpolicylabel_binding","videooptimizationdetectionpolicylabel_policybinding_binding","videooptimizationdetectionpolicylabel_videooptimizationdetectionpolicy_binding","videooptimizationglobaldetection","videooptimizationglobaldetection_binding","videooptimizationglobaldetection_videooptimizationdetectionpolicy_binding","videooptimizationglobalpacing","videooptimizationglobalpacing_binding","videooptimizationglobalpacing_videooptimizationpacingpolicy_binding","videooptimizationpacingaction","videooptimizationpacingpolicy","videooptimizationpacingpolicy_binding","videooptimizationpacingpolicy_lbvserver_binding","videooptimizationpacingpolicy_videooptimizationglobalpacing_binding","videooptimizationpacingpolicylabel","videooptimizationpacingpolicylabel_binding","videooptimizationpacingpolicylabel_policybinding_binding","videooptimizationpacingpolicylabel_videooptimizationpacingpolicy_binding","videooptimizationparameter","vlan","vlan_binding","vlan_channel_binding","vlan_interface_binding","vlan_linkset_binding","vlan_nsip6_binding","vlan_nsip_binding","vpnalwaysonprofile","vpnclientlessaccesspolicy","vpnclientlessaccesspolicy_binding","vpnclientlessaccesspolicy_vpnglobal_binding","vpnclientlessaccesspolicy_vpnvserver_binding","vpnclientlessaccessprofile","vpnepaprofile","vpneula","vpnformssoaction","vpnglobal","vpnglobal_binding","vpnglobal_appcontroller_binding","vpnglobal_auditnslogpolicy_binding","vpnglobal_auditsyslogpolicy_binding","vpnglobal_authenticationcertpolicy_binding","vpnglobal_authenticationldappolicy_binding","vpnglobal_authenticationlocalpolicy_binding","vpnglobal_authenticationnegotiatepolicy_binding","vpnglobal_authenticationpolicy_binding","vpnglobal_authenticationradiuspolicy_binding","vpnglobal_authenticationsamlpolicy_binding","vpnglobal_authenticationtacacspolicy_binding","vpnglobal_domain_binding","vpnglobal_intranetip6_binding","vpnglobal_intranetip_binding","vpnglobal_sharefileserver_binding","vpnglobal_sslcertkey_binding","vpnglobal_staserver_binding","vpnglobal_vpnclientlessaccesspolicy_binding","vpnglobal_vpneula_binding","vpnglobal_vpnintranetapplication_binding","vpnglobal_vpnnexthopserver_binding","vpnglobal_vpnportaltheme_binding","vpnglobal_vpnsessionpolicy_binding","vpnglobal_vpntrafficpolicy_binding","vpnglobal_vpnurl_binding","vpnicaconnection","vpnicadtlsconnection","vpnintranetapplication","vpnnexthopserver","vpnparameter","vpnpcoipconnection","vpnpcoipprofile","vpnpcoipvserverprofile","vpnportaltheme","vpnsamlssoprofile","vpnsessionaction","vpnsessionpolicy","vpnsessionpolicy_binding","vpnsessionpolicy_aaagroup_binding","vpnsessionpolicy_aaauser_binding","vpnsessionpolicy_vpnglobal_binding","vpnsessionpolicy_vpnvserver_binding","vpnsfconfig","vpnstoreinfo","vpntrafficaction","vpntrafficpolicy","vpntrafficpolicy_binding","vpntrafficpolicy_aaagroup_binding","vpntrafficpolicy_aaauser_binding","vpntrafficpolicy_vpnglobal_binding","vpntrafficpolicy_vpnvserver_binding","vpnurl","vpnvserver","vpnvserver_binding","vpnvserver_aaapreauthenticationpolicy_binding","vpnvserver_appcontroller_binding","vpnvserver_appflowpolicy_binding","vpnvserver_auditnslogpolicy_binding","vpnvserver_auditsyslogpolicy_binding","vpnvserver_authenticationcertpolicy_binding","vpnvserver_authenticationdfapolicy_binding","vpnvserver_authenticationldappolicy_binding","vpnvserver_authenticationlocalpolicy_binding","vpnvserver_authenticationloginschemapolicy_binding","vpnvserver_authenticationnegotiatepolicy_binding","vpnvserver_authenticationoauthidppolicy_binding","vpnvserver_authenticationpolicy_binding","vpnvserver_authenticationradiuspolicy_binding","vpnvserver_authenticationsamlidppolicy_binding","vpnvserver_authenticationsamlpolicy_binding","vpnvserver_authenticationtacacspolicy_binding","vpnvserver_authenticationwebauthpolicy_binding","vpnvserver_cachepolicy_binding","vpnvserver_cspolicy_binding","vpnvserver_feopolicy_binding","vpnvserver_icapolicy_binding","vpnvserver_intranetip6_binding","vpnvserver_intranetip_binding","vpnvserver_responderpolicy_binding","vpnvserver_rewritepolicy_binding","vpnvserver_sharefileserver_binding","vpnvserver_staserver_binding","vpnvserver_vpnclientlessaccesspolicy_binding","vpnvserver_vpnepaprofile_binding","vpnvserver_vpneula_binding","vpnvserver_vpnintranetapplication_binding","vpnvserver_vpnnexthopserver_binding","vpnvserver_vpnportaltheme_binding","vpnvserver_vpnsessionpolicy_binding","vpnvserver_vpntrafficpolicy_binding","vpnvserver_vpnurl_binding","vrid","vrid_binding","vrid6","vrid6_binding","vrid6_channel_binding","vrid6_interface_binding","vrid6_nsip6_binding","vrid6_nsip_binding","vrid6_trackinterface_binding","vrid_channel_binding","vrid_interface_binding","vrid_nsip6_binding","vrid_nsip_binding","vrid_trackinterface_binding","vridparam","vserver","vxlan","vxlan_binding","vxlan_iptunnel_binding","vxlan_nsip6_binding","vxlan_nsip_binding","vxlan_srcip_binding","vxlanvlanmap","vxlanvlanmap_binding","vxlanvlanmap_vxlan_binding","wfpackage","wfsite","wipackage","wisite","wisite_binding","wisite_accessmethod_binding","wisite_farmname_binding","wisite_translationinternalip_binding","xmdeployment","xmpackage")
    [string[]]$AllStatElements = @("aaa","appflow","appfw","appfwpolicy","appfwpolicylabel","appfwprofile","appqoe","appqoepolicy","audit","authenticationloginschemapolicy","authenticationoauthidppolicy","authenticationpolicy","authenticationpolicylabel","authenticationsamlidppolicy","authenticationvserver","authorizationpolicylabel","autoscalepolicy","bridge","ca","cache","cachecontentgroup","cachepolicy","cachepolicylabel","clusterinstance","clusternode","cmp","cmppolicy","cmppolicylabel","contentinspectionpolicy","contentinspectionpolicylabel","crvserver","csvserver","dns","dnspolicylabel","dnsrecords","dos","dospolicy","feo","gslbdomain","gslbservice","gslbservicegroup","gslbservicegroupmember","gslbsite","gslbvserver","hanode","icapolicy","inat","inatsession","Interface","ipsecalgcounters","ipseccounters","lbvserver","lldp","lsn","lsndslite","lsngroup","lsnnat64","lsnpool","mapbmr","mapdomain","nat64","ns","nsacl","nsacl6","nslimitidentifier","nsmemory","nspartition","nspbr","nspbr6","nssimpleacl","nssimpleacl6","nstrafficdomain","pcpserver","pq","pqpolicy","protocolhttp","protocolicmp","protocolicmpv6","protocolip","protocolipv6","protocolmptcp","protocoltcp","protocoludp","qos","responderpolicy","responderpolicylabel","rewritepolicy","rewritepolicylabel","rnat","rnat6","rnatip","sc","scpolicy","service","servicegroup","servicegroupmember","snmp","spilloverpolicy","ssl","sslvserver","streamidentifier","system","systembw","systemcpu","systemmemory","tmsessionpolicy","tmtrafficpolicy","transformpolicy","transformpolicylabel","tunnelip","tunnelip6","tunneltrafficpolicy","uservserver","videooptimization","videooptimizationdetectionpolicy","videooptimizationdetectionpolicylabel","videooptimizationpacingpolicy","videooptimizationpacingpolicylabel","vlan","vpn","vpnvserver","vxlan")
  }
  else {
    [string[]]$AllConfigElements = @($NSConfigElement)
  }
  if ($Stat) {
    $ConfigOrStats = 'stat'
    [string[]]$NSElements = $NSStatElement
  }
  elseif ($Config) {
    $ConfigOrStats = 'config'
    [string[]]$NSElements =  $AllConfigElements
  } 
  $TotalElementCount = $NSElements.Count
  $currentElementnumber = 0
  foreach ($NSElement in $NSElements) {
    try {
      $currentElementnumber++
      Write-Progress -Activity 'Creating Report' -PercentComplete ($currentElementnumber/$TotalElementCount*100) 
      $NSURL = "http://$NSIPAddress/nitro/v1/$ConfigOrStats/$NSElement"
      $NSInfo = Invoke-RestMethod -Method Get -Uri $NSURL -Credential $creds -ErrorAction stop
      if ($NSInfo.($NSElement) -ne $null) {
        $HtmlFrags += $NSInfo.($NSElement) | ConvertTo-Html -Fragment -PreContent "<h2>$NSElement</h2>"
      }
    }
    catch {
    
    }
  }
  $ReportFileName = 'NSReport'+ (get-date -UFormat '-%H%M-%d%m%Y.html')
  $FullPath = $HTMLReportDirectory.trimend('\') + '\' + $ReportFileName
  ConvertTo-Html -Head $CSS -Body $HtmlFrags | Out-File $FullPath
}

function Import-CitrixPolicyModule {
    <#
  .Synopsis
     This command loads the Citrix Scout/Telemetry Policy module
  .DESCRIPTION
     This command will detect if your system is 7.15 or later or not and load the 
     equivalent module from the correct directory. Citrix 7.15 and later Scout was
     added to the product and was re-badged as Telemetry. This command must be run
     on a Delivery Controller
  .EXAMPLE
     Import-CitrixPolicyModule
  .NOTES
     General notes
       Created by:  Brent Denny
       Created on:  7 Aug 2019
       Modified on: 7 Aug 2019
  #>
  [cmdletbinding()]
  Param( )
  
  $ProgressPreference = 'silent'
  $BrokerService = Get-Service | Where-Object {$_.name -eq 'CitrixBrokerService' }
  $ProgressPreference = 'continue'
  if ($BrokerService.count -eq 1 -and $BrokerService.Status -eq 'Running') {
    $Controllers = Get-BrokerController 
    [int]$MajVersion = ($Controllers.ControllerVersion -split '\.')[0]
    [int]$SubVersion = ($Controllers.ControllerVersion -split '\.')[1]
    if ($MajVersion -eq 7) {
      if ($SubVersion -ge 15) {
        Import-Module -Global 'C:\Program Files\Citrix\Telemetry Service\TelemetryModule\Citrix.GroupPolicy.Commands.psm1'
      }
      else {
        $LegacyModuleAvailable = Test-Path 'C:\Program Files (x86)\Citrix\Scout\Current\Utilities\Citrix.GroupPolicy.Commands.psm1'
        if ($LegacyModuleAvailable -eq $true) {
          Import-Module -Global 'C:\Program Files (x86)\Citrix\Scout\Current\Utilities\Citrix.GroupPolicy.Commands.psm1'
        }
        else {Write-warning 'Scout has not been installed on this Delivery Controller'}
      }
    }
    else {write-warning "Citrix version is not equal to 7"}
  }
  else {Write-Warning "Could not contact $DeliveryController"}
  $CTXPSDrive = New-PSDrive -PSProvider CitrixGroupPolicy -Name LocalFarmGpo -root \ -Controller localhost -Scope Global
  Clear-Host
  Write-Host "`nPowerShell commands now available for Policy management" -ForegroundColor Yellow
  (Get-Command -Module Citrix.GroupPolicy.Commands).Name
}
